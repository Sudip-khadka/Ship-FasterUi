import{r as o,b as k}from"./index-DUAV1Q2A.js";import{b as R,c as O,u as P}from"./index-CkJYSq-f.js";import{P as D,d as j}from"./index-BBSvTbSE.js";import{u as A}from"./index-HDiuFCMG.js";import{j as C}from"./jsx-runtime-D_zvdyIk.js";import{G as z}from"./index-VDvXe9nZ.js";function H(t,e=globalThis==null?void 0:globalThis.document){const r=R(t);o.useEffect(()=>{const n=s=>{s.key==="Escape"&&r(s)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[r,e])}var G="DismissableLayer",L="dismissableLayer.update",K="dismissableLayer.pointerDownOutside",V="dismissableLayer.focusOutside",I,U=o.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),X=o.forwardRef((t,e)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:a,onInteractOutside:l,onDismiss:u,...f}=t,i=o.useContext(U),[c,v]=o.useState(null),m=(c==null?void 0:c.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,E]=o.useState({}),b=A(e,d=>v(d)),p=Array.from(i.layers),[N]=[...i.layersWithOutsidePointerEventsDisabled].slice(-1),F=p.indexOf(N),T=c?p.indexOf(c):-1,B=i.layersWithOutsidePointerEventsDisabled.size>0,w=T>=F,_=q(d=>{const y=d.target,M=[...i.branches].some(g=>g.contains(y));!w||M||(s==null||s(d),l==null||l(d),d.defaultPrevented||u==null||u())},m),S=J(d=>{const y=d.target;[...i.branches].some(g=>g.contains(y))||(a==null||a(d),l==null||l(d),d.defaultPrevented||u==null||u())},m);return H(d=>{T===i.layers.size-1&&(n==null||n(d),!d.defaultPrevented&&u&&(d.preventDefault(),u()))},m),o.useEffect(()=>{if(c)return r&&(i.layersWithOutsidePointerEventsDisabled.size===0&&(I=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),i.layersWithOutsidePointerEventsDisabled.add(c)),i.layers.add(c),x(),()=>{r&&i.layersWithOutsidePointerEventsDisabled.size===1&&(m.body.style.pointerEvents=I)}},[c,m,r,i]),o.useEffect(()=>()=>{c&&(i.layers.delete(c),i.layersWithOutsidePointerEventsDisabled.delete(c),x())},[c,i]),o.useEffect(()=>{const d=()=>E({});return document.addEventListener(L,d),()=>document.removeEventListener(L,d)},[]),C.jsx(D.div,{...f,ref:b,style:{pointerEvents:B?w?"auto":"none":void 0,...t.style},onFocusCapture:O(t.onFocusCapture,S.onFocusCapture),onBlurCapture:O(t.onBlurCapture,S.onBlurCapture),onPointerDownCapture:O(t.onPointerDownCapture,_.onPointerDownCapture)})});X.displayName=G;var Y="DismissableLayerBranch",$=o.forwardRef((t,e)=>{const r=o.useContext(U),n=o.useRef(null),s=A(e,n);return o.useEffect(()=>{const a=n.current;if(a)return r.branches.add(a),()=>{r.branches.delete(a)}},[r.branches]),C.jsx(D.div,{...t,ref:s})});$.displayName=Y;function q(t,e=globalThis==null?void 0:globalThis.document){const r=R(t),n=o.useRef(!1),s=o.useRef(()=>{});return o.useEffect(()=>{const a=u=>{if(u.target&&!n.current){let f=function(){W(K,r,i,{discrete:!0})};const i={originalEvent:u};u.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=f,e.addEventListener("click",s.current,{once:!0})):f()}else e.removeEventListener("click",s.current);n.current=!1},l=window.setTimeout(()=>{e.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(l),e.removeEventListener("pointerdown",a),e.removeEventListener("click",s.current)}},[e,r]),{onPointerDownCapture:()=>n.current=!0}}function J(t,e=globalThis==null?void 0:globalThis.document){const r=R(t),n=o.useRef(!1);return o.useEffect(()=>{const s=a=>{a.target&&!n.current&&W(V,r,{originalEvent:a},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function x(){const t=new CustomEvent(L);document.dispatchEvent(t)}function W(t,e,r,{discrete:n}){const s=r.originalEvent.target,a=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});e&&s.addEventListener(t,e,{once:!0}),n?j(s,a):s.dispatchEvent(a)}var Q=k.useId||(()=>{}),Z=0;function fe(t){const[e,r]=o.useState(Q());return P(()=>{r(n=>n??String(Z++))},[t]),t||(e?`radix-${e}`:"")}var ee="Portal",te=o.forwardRef((t,e)=>{var u;const{container:r,...n}=t,[s,a]=o.useState(!1);P(()=>a(!0),[]);const l=r||s&&((u=globalThis==null?void 0:globalThis.document)==null?void 0:u.body);return l?z.createPortal(C.jsx(D.div,{...n,ref:e}),l):null});te.displayName=ee;function ne(t,e){return o.useReducer((r,n)=>e[r][n]??r,t)}var re=t=>{const{present:e,children:r}=t,n=se(e),s=typeof r=="function"?r({present:n.isPresent}):o.Children.only(r),a=A(n.ref,ie(s));return typeof r=="function"||n.isPresent?o.cloneElement(s,{ref:a}):null};re.displayName="Presence";function se(t){const[e,r]=o.useState(),n=o.useRef({}),s=o.useRef(t),a=o.useRef("none"),l=t?"mounted":"unmounted",[u,f]=ne(l,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return o.useEffect(()=>{const i=h(n.current);a.current=u==="mounted"?i:"none"},[u]),P(()=>{const i=n.current,c=s.current;if(c!==t){const m=a.current,E=h(i);t?f("MOUNT"):E==="none"||(i==null?void 0:i.display)==="none"?f("UNMOUNT"):f(c&&m!==E?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,f]),P(()=>{if(e){let i;const c=e.ownerDocument.defaultView??window,v=E=>{const p=h(n.current).includes(E.animationName);if(E.target===e&&p&&(f("ANIMATION_END"),!s.current)){const N=e.style.animationFillMode;e.style.animationFillMode="forwards",i=c.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=N)})}},m=E=>{E.target===e&&(a.current=h(n.current))};return e.addEventListener("animationstart",m),e.addEventListener("animationcancel",v),e.addEventListener("animationend",v),()=>{c.clearTimeout(i),e.removeEventListener("animationstart",m),e.removeEventListener("animationcancel",v),e.removeEventListener("animationend",v)}}else f("ANIMATION_END")},[e,f]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:o.useCallback(i=>{i&&(n.current=getComputedStyle(i)),r(i)},[])}}function h(t){return(t==null?void 0:t.animationName)||"none"}function ie(t){var n,s;let e=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}export{X as D,re as P,te as a,fe as u};
